.data
SYSREAD = 0
SYSWRITE = 1
STDIN = 0
STDOUT = 1
SYSEXIT = 60
EXIT_SUCCESS = 0
BUF_LEN = 512

.bss
.comm buf_read, 512
.comm buf_write, 512
.comm buf_read_len, 512
.text
.globl _start

_start:
nop
movq $SYSREAD, %rax
movq $STDIN, %rdi
movq $buf_read, %rsi
movq $BUF_LEN, %rdx
syscall

dec %rax
mov %rax, buf_read_len
movq $0, %rdi

petla:
movq $0, %rdx
movq $buf_read, %rax
movq $7, %rcx
div %rcx
add %rdx, buf_write
inc %rdi
cmp $buf_read_len, %rdi
jg petla
#movb $'\n', buf_write(,%rdi,1)

movq $SYSWRITE, %rax
movq $STDOUT, %rdi
movq $buf_write, %rsi
movq $BUF_LEN, %rdx
syscall


movq $SYSEXIT, %rax
movq $EXIT_SUCCESS, %rdi
syscall

